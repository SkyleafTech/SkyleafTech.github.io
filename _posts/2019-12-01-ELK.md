---
layout:     post
title:      Private Nuget Server
subtitle:   Private Nuget Server
date:       2017-11-23
author:     BY Skyleaf
header-img: img/post-bg-ios9-web.jpg
catalog: true
tags:
    - NPE
    - Private Nuget Server
---
# 前言

> Private Nuget Server。

![图](https://images.unsplash.com/photo-1512908593802-fc940f380825?ixlib=rb-0.3.5&ixid=eyJhcHBfaWQiOjEyMDd9&s=0f62467b0ddc485a091cce9f93f48ae3&auto=format&fit=crop&w=1950&q=80)
# 一般狀況介紹有兩種

- NuGet Gallery (Public)
- NuGet Server (Private)

#### 操作須知

1. ELK 6.5.4
2. Beats: (Filebeat, Winlogbeat, packetbeat, healthcheck )
3. nssm
4. 
5. 
10. 


#### 操作想法

很多專案，對應的就是很多Log，改怎麼做呢? 登嘞: ELK，以前我只使用ElasticSearch跟Logstash。但時日一久後，發現還有推出Beats系列產品。如果你有10個不同專案，每個專案有3台機器要部屬，以前做法是開一個共同的環境來接手所有的Log檔案。但這樣很麻煩，而且要麻煩別的老屁股。真的很麻煩XD。

透過Elasticsearch去存log資料，透過Logstash去接收log資料，透過Kibana介面去查看log資料。Filebeat就是client端做扒log資料到發送log資料到Server端的Logstash。優點就是解決跟其他單位溝通時間。

#### 操作方法

1. VS 2017 開專案，建立一個空的專案，去安裝Nuget.Server。安裝好後執行F5。

2. 由於我的Default是4.6.1，所以我的targetFramework是4.6.1，但安裝完套件會綁你自動建立4.6。你必須手動刪除他。



3. 之後搭配[**忠成老師**](https://dotblogs.com.tw/code6421/2016/02/29/015739)的BasicAuthHttpModule類別做驗證機制。帳密在程式碼內(user/password)。也可透過老師提供的語法新增修改。
    - 新增: 
        - `nuget sources add -Name "privateServer" -Source "http://localhost/nuget" -UserName "abc1" -Password "123"`
    - 修改: 
        - `nuget sources update -Name "privateServer" -Source "http://localhost/nuget" -UserName "abc2" -Password "1234"`

4. 使用Nuget Package Exploer (NPE)工具去建置，可以使用choco安裝

        `choco install nugetpackageexplorer`


5. 透過NPE加入dependencies在加入自己的library的dll，要套用到你.net建置的版本folder


6. 還可以使用unpkg檔案建立package的內容，icon等等。但有了NPE後對一般使用者來說比較直覺一點，這就看你自己了，這跟publish你可以使用[**Nuget.exe**](https://www.nuget.org/downloads) Publish一樣。都可以。

 - ![alt][img1]
 - ![alt][img2]

7. 接著建立新的測試專案，去Nuget Manager加入新的Nuget Server位置

8. 下載後即可使用。


## 實戰：遇到的一些問題

    Q: 一直回傳回傳 500 錯誤?
    A: 這篇，原來是folder的權限不足。

    Q: publish 時候遇到406錯誤?
    A: 這篇，sthkn commented on Dec 16, 2017說到只需要在Web.config 打開allowOverrideExistingPackageOnPush設定即可。

#### 閒言閒語
1. 要懂.Net
2. 有想解決reference問題
3. .Net Core之後都是採用Nuget方式，想提前熟悉
4. 想節省新人培訓時間

#### 來源

1. [**版控的下一步**](https://dotblogs.com.tw/code6421/2016/02/29/015739)
2. [**NPE**](https://github.com/NuGetPackageExplorer/NuGetPackageExplorer)
3. [**Nuget.exe**](https://www.nuget.org/downloads)
4. [**creating-a-package**](https://docs.microsoft.com/en-us/nuget/create-packages/creating-a-package)
5. [**nugetexe-cli**](https://docs.microsoft.com/en-us/nuget/install-nuget-client-tools#nugetexe-cli)






```

```	
		

